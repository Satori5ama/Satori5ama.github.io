<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>计算几何 on 终端出口</title><link>https://username.github.io/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95/</link><description>Recent content from 终端出口</description><generator>Hugo</generator><language>en</language><managingEditor>satori5ama@foxmail.com (Satori5ama)</managingEditor><webMaster>satori5ama@foxmail.com (Satori5ama)</webMaster><copyright>All articles on this blog are licensed under the BY-NC-SA license agreement unless otherwise stated. Please indicate the source when reprinting!</copyright><lastBuildDate>Sun, 21 Jul 2024 19:52:25 +0800</lastBuildDate><atom:link href="https://username.github.io/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95/index.xml" rel="self" type="application/rss+xml"/><item><title>两凸包间距离——GJK算法（POJ 3608）</title><link>https://username.github.io/post/gjk-algorithm/</link><pubDate>Sun, 21 Jul 2024 08:52:25 +0800</pubDate><author>satori5ama@foxmail.com (Satori5ama)</author><guid>https://username.github.io/post/gjk-algorithm/</guid><description>
<![CDATA[<h1>两凸包间距离——GJK算法（POJ 3608）</h1><p>Author: Satori5ama(satori5ama@foxmail.com)</p>
        
          <p>起因：数模期末大作业，求空域在平面投影上相互之间最短距离是否小于安全距离。空域投影的形状有圆形，凸多边形，跑道形。</p>
<p>使用GJK算法的代码：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include&lt;bits/stdc++.h&gt;  
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl"><span class="cp">#define double long double  
</span></span></span><span class="line"><span class="cl"><span class="cp">#define x first  
</span></span></span><span class="line"><span class="cl"><span class="cp">#define y second  
</span></span></span><span class="line"><span class="cl"><span class="cp">#define MIN(a,b,c,d) (min(min(min(a,b),c),d))  
</span></span></span><span class="line"><span class="cl"><span class="cp">#define MAX(a,b,c,d) (max(max(max(a,b),c),d))  
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">typedef</span> <span class="n">pair</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="kt">double</span><span class="o">&gt;</span> <span class="n">P</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="kt">unsigned</span> <span class="n">uint</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">P</span> <span class="n">origin</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">double</span> <span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">;</span>    
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">shape</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">type</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span> <span class="n">poly</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl"><span class="p">};</span>  
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">P</span> <span class="nf">add</span><span class="p">(</span><span class="n">P</span> <span class="n">a</span><span class="p">,</span> <span class="n">P</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">P</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">);</span> <span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">P</span> <span class="nf">del</span><span class="p">(</span><span class="n">P</span> <span class="n">a</span><span class="p">,</span> <span class="n">P</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">P</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">);</span> <span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">P</span> <span class="nf">Minus</span><span class="p">(</span><span class="n">P</span> <span class="n">a</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">P</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="p">);</span> <span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">double</span> <span class="nf">dot</span><span class="p">(</span><span class="n">P</span> <span class="n">a</span><span class="p">,</span> <span class="n">P</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">b</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">;</span> <span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">double</span> <span class="nf">det</span><span class="p">(</span><span class="n">P</span> <span class="n">a</span><span class="p">,</span> <span class="n">P</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">b</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="p">;</span> <span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">P</span> <span class="nf">mul</span><span class="p">(</span><span class="n">P</span> <span class="n">a</span><span class="p">,</span> <span class="kt">double</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">P</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">b</span><span class="p">);</span> <span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">bool</span> <span class="nf">isEquals</span><span class="p">(</span><span class="n">P</span> <span class="n">p1</span><span class="p">,</span> <span class="n">P</span> <span class="n">p2</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">abs</span><span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">p2</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span> <span class="o">&amp;&amp;</span> <span class="n">abs</span><span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">p2</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl"><span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">double</span> <span class="nf">len</span><span class="p">(</span><span class="n">P</span> <span class="n">a</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="p">);</span> <span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">P</span> <span class="nf">normalize</span><span class="p">(</span><span class="n">P</span> <span class="n">a</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">P</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">/</span> <span class="n">len</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">/</span> <span class="n">len</span><span class="p">(</span><span class="n">a</span><span class="p">));</span> <span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">P</span> <span class="nf">support_poly</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span> <span class="n">poly</span><span class="p">,</span> <span class="n">P</span> <span class="n">dir</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="n">P</span> <span class="n">sup</span> <span class="o">=</span> <span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>  
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">maxs</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">sup</span><span class="p">,</span> <span class="n">dir</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="n">uint</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">poly</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">poly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dir</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">maxs</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">            <span class="n">maxs</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">poly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dir</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">            <span class="n">sup</span> <span class="o">=</span> <span class="n">poly</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>  
</span></span><span class="line"><span class="cl">        <span class="p">}</span>  
</span></span><span class="line"><span class="cl">    <span class="p">}</span>  
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">sup</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl"><span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">P</span> <span class="nf">support_circle</span><span class="p">(</span><span class="kt">int</span> <span class="n">ox</span><span class="p">,</span> <span class="kt">int</span> <span class="n">oy</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="n">P</span> <span class="n">dir</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">add</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">ox</span><span class="p">,</span> <span class="n">oy</span><span class="p">),</span> <span class="n">mul</span><span class="p">(</span><span class="n">normalize</span><span class="p">(</span><span class="n">dir</span><span class="p">),</span> <span class="n">r</span><span class="p">));</span>  
</span></span><span class="line"><span class="cl"><span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">P</span> <span class="nf">support</span><span class="p">(</span><span class="n">shape</span> <span class="n">s</span><span class="p">,</span> <span class="n">P</span> <span class="n">dir</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">        <span class="kt">double</span> <span class="n">ox</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">x</span> <span class="o">+</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">x</span> <span class="o">+</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">x</span> <span class="o">+</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">,</span>  
</span></span><span class="line"><span class="cl">               <span class="n">oy</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">y</span> <span class="o">+</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">y</span> <span class="o">+</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">y</span> <span class="o">+</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">,</span>  
</span></span><span class="line"><span class="cl">               <span class="n">r</span> <span class="o">=</span> <span class="n">fabs</span><span class="p">((</span><span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">y</span> <span class="o">-</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">support_circle</span><span class="p">(</span><span class="n">ox</span><span class="p">,</span> <span class="n">oy</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">dir</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">    <span class="p">}</span>  
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">type</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">        <span class="kt">double</span> <span class="n">r</span> <span class="o">=</span> <span class="n">fabs</span><span class="p">((</span><span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">y</span> <span class="o">-</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">        <span class="kt">double</span> <span class="n">ox1</span> <span class="o">=</span> <span class="n">MIN</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">r</span><span class="p">,</span>  
</span></span><span class="line"><span class="cl">               <span class="n">oy1</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">y</span> <span class="o">+</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">        <span class="kt">double</span> <span class="n">ox2</span> <span class="o">=</span> <span class="n">MAX</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">r</span><span class="p">,</span>  
</span></span><span class="line"><span class="cl">               <span class="n">oy2</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">y</span> <span class="o">+</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">        <span class="n">vector</span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span> <span class="n">poly</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">        <span class="n">poly</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">ox1</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">y</span><span class="p">));</span>  
</span></span><span class="line"><span class="cl">        <span class="n">poly</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">ox1</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">y</span><span class="p">));</span>  
</span></span><span class="line"><span class="cl">        <span class="n">poly</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">ox2</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">y</span><span class="p">));</span>  
</span></span><span class="line"><span class="cl">        <span class="n">poly</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">ox2</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="n">y</span><span class="p">));</span>  
</span></span><span class="line"><span class="cl">        <span class="n">P</span> <span class="n">sup</span> <span class="o">=</span> <span class="n">support_poly</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">dir</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">        <span class="kt">double</span> <span class="n">maxs</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">sup</span><span class="p">,</span> <span class="n">dir</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">        <span class="n">P</span> <span class="n">res</span> <span class="o">=</span> <span class="n">support_circle</span><span class="p">(</span><span class="n">ox1</span><span class="p">,</span> <span class="n">oy1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">dir</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">dir</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">maxs</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">            <span class="n">maxs</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">dir</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">            <span class="n">sup</span> <span class="o">=</span> <span class="n">res</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">        <span class="p">}</span>  
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">=</span> <span class="n">support_circle</span><span class="p">(</span><span class="n">ox2</span><span class="p">,</span> <span class="n">oy2</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">dir</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">dir</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">maxs</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">            <span class="n">maxs</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">dir</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">            <span class="n">sup</span> <span class="o">=</span> <span class="n">res</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">        <span class="p">}</span>  
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">sup</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">    <span class="p">}</span>  
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">support_poly</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">poly</span><span class="p">,</span> <span class="n">dir</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">double</span> <span class="nf">calcTriangleArea</span><span class="p">(</span><span class="n">P</span> <span class="n">p1</span><span class="p">,</span> <span class="n">P</span> <span class="n">p2</span><span class="p">,</span> <span class="n">P</span> <span class="n">p3</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">fabs</span><span class="p">(</span><span class="n">det</span><span class="p">(</span><span class="n">del</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p1</span><span class="p">),</span> <span class="n">del</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">p1</span><span class="p">)))</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl"><span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">bool</span> <span class="nf">isContainOrigin</span><span class="p">(</span><span class="n">P</span> <span class="n">p1</span><span class="p">,</span> <span class="n">P</span> <span class="n">p2</span><span class="p">,</span> <span class="n">P</span> <span class="n">p3</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">calcTriangleArea</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">calcTriangleArea</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p3</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">s3</span> <span class="o">=</span> <span class="n">calcTriangleArea</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">s</span> <span class="o">=</span> <span class="n">calcTriangleArea</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">fabs</span><span class="p">(</span><span class="n">s1</span> <span class="o">+</span> <span class="n">s2</span> <span class="o">+</span> <span class="n">s3</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl"><span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">P</span> <span class="nf">GetNextDirection</span><span class="p">(</span><span class="n">P</span> <span class="n">a</span><span class="p">,</span> <span class="n">P</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="n">P</span> <span class="n">ab</span> <span class="o">=</span> <span class="n">del</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">),</span> <span class="n">ao</span> <span class="o">=</span> <span class="n">del</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">P</span><span class="p">(</span><span class="o">-</span><span class="n">ab</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">det</span><span class="p">(</span><span class="n">ab</span><span class="p">,</span> <span class="n">ao</span><span class="p">),</span> <span class="n">ab</span><span class="p">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">det</span><span class="p">(</span><span class="n">ab</span><span class="p">,</span> <span class="n">ao</span><span class="p">));</span>  
</span></span><span class="line"><span class="cl"><span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">P</span> <span class="nf">NearestPointToOrigin</span><span class="p">(</span><span class="n">P</span> <span class="n">a</span><span class="p">,</span> <span class="n">P</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">isEquals</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span> <span class="k">return</span> <span class="n">Minus</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">    <span class="n">P</span> <span class="n">ab</span> <span class="o">=</span> <span class="n">del</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">),</span> <span class="n">ba</span> <span class="o">=</span> <span class="n">del</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">ap</span> <span class="o">=</span> <span class="n">Minus</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">bp</span> <span class="o">=</span> <span class="n">Minus</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">ab</span><span class="p">,</span> <span class="n">ap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">dot</span><span class="p">(</span><span class="n">ba</span><span class="p">,</span> <span class="n">bp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">mul</span><span class="p">(</span><span class="n">normalize</span><span class="p">(</span><span class="n">GetNextDirection</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)),</span> <span class="n">fabs</span><span class="p">(</span><span class="n">det</span><span class="p">(</span><span class="n">ab</span><span class="p">,</span> <span class="n">ap</span><span class="p">)</span> <span class="o">/</span> <span class="n">len</span><span class="p">(</span><span class="n">ab</span><span class="p">)));</span>  
</span></span><span class="line"><span class="cl">    <span class="p">}</span>  
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">?</span> <span class="n">Minus</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">:</span> <span class="n">Minus</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl"><span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">bool</span> <span class="nf">isinaline</span><span class="p">(</span><span class="n">P</span> <span class="n">a</span><span class="p">,</span> <span class="n">P</span> <span class="n">b</span><span class="p">,</span> <span class="n">P</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">fabs</span><span class="p">(</span><span class="n">det</span><span class="p">(</span><span class="n">del</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">del</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">)))</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">double</span> <span class="nf">GJK</span><span class="p">(</span><span class="n">shape</span> <span class="n">p</span><span class="p">,</span> <span class="n">shape</span> <span class="n">q</span><span class="p">,</span> <span class="n">P</span> <span class="n">D</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="n">P</span> <span class="n">A</span> <span class="o">=</span> <span class="n">del</span><span class="p">(</span><span class="n">support</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">D</span><span class="p">),</span> <span class="n">support</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">Minus</span><span class="p">(</span><span class="n">D</span><span class="p">)));</span>  
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span> <span class="n">simplex</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">    <span class="n">simplex</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">    <span class="n">P</span> <span class="n">B</span> <span class="o">=</span> <span class="n">del</span><span class="p">(</span><span class="n">support</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Minus</span><span class="p">(</span><span class="n">D</span><span class="p">)),</span> <span class="n">support</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">D</span><span class="p">));</span>  
</span></span><span class="line"><span class="cl">    <span class="n">simplex</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">B</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">isinaline</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">origin</span><span class="p">))</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">    <span class="n">D</span> <span class="o">=</span> <span class="n">NearestPointToOrigin</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="nb">true</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">        <span class="n">P</span> <span class="n">C</span> <span class="o">=</span> <span class="n">del</span><span class="p">(</span><span class="n">support</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">D</span><span class="p">),</span> <span class="n">support</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">Minus</span><span class="p">(</span><span class="n">D</span><span class="p">)));</span>  
</span></span><span class="line"><span class="cl">        <span class="n">A</span> <span class="o">=</span> <span class="n">simplex</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">simplex</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>  
</span></span><span class="line"><span class="cl">        <span class="n">B</span> <span class="o">=</span> <span class="n">simplex</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">simplex</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>  
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">isContainOrigin</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">))</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">        <span class="kt">double</span> <span class="n">da</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">D</span><span class="p">),</span> <span class="n">db</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">D</span><span class="p">),</span> <span class="n">dc</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">da</span> <span class="o">-</span> <span class="n">dc</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span> <span class="o">||</span> <span class="n">fabs</span><span class="p">(</span><span class="n">db</span> <span class="o">-</span> <span class="n">dc</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">)</span> <span class="k">return</span> <span class="n">len</span><span class="p">(</span><span class="n">D</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">        <span class="n">P</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">NearestPointToOrigin</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">C</span><span class="p">),</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">NearestPointToOrigin</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">        <span class="n">simplex</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">C</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">        <span class="kt">double</span> <span class="n">len1</span> <span class="o">=</span> <span class="n">len</span><span class="p">(</span><span class="n">p1</span><span class="p">),</span> <span class="n">len2</span> <span class="o">=</span> <span class="n">len</span><span class="p">(</span><span class="n">p2</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">len1</span> <span class="o">&lt;</span> <span class="n">len2</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">            <span class="n">simplex</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">            <span class="n">D</span> <span class="o">=</span> <span class="n">p1</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">            <span class="n">simplex</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">B</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">            <span class="n">D</span> <span class="o">=</span> <span class="n">p2</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">        <span class="p">}</span>  
</span></span><span class="line"><span class="cl">    <span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="p">}</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">shape</span> <span class="n">s</span><span class="p">[</span><span class="mi">105</span><span class="p">];</span>  
</span></span><span class="line"><span class="cl"><span class="kt">double</span> <span class="n">h1</span><span class="p">[</span><span class="mi">105</span><span class="p">],</span> <span class="n">h2</span><span class="p">[</span><span class="mi">105</span><span class="p">],</span> <span class="n">t1</span><span class="p">[</span><span class="mi">105</span><span class="p">],</span> <span class="n">t2</span><span class="p">[</span><span class="mi">105</span><span class="p">];</span>  
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">double</span> <span class="n">hc</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">pc</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">tc</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="n">freopen</span><span class="p">(</span><span class="s">&#34;data.in&#34;</span><span class="p">,</span> <span class="s">&#34;r&#34;</span><span class="p">,</span> <span class="n">stdin</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">    <span class="n">freopen</span><span class="p">(</span><span class="s">&#34;data.out&#34;</span><span class="p">,</span> <span class="s">&#34;w&#34;</span><span class="p">,</span> <span class="n">stdout</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">id</span><span class="p">)</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">        <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">s</span><span class="p">[</span><span class="n">id</span><span class="p">].</span><span class="n">type</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">id</span><span class="p">].</span><span class="n">type</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">||</span> <span class="n">s</span><span class="p">[</span><span class="n">id</span><span class="p">].</span><span class="n">type</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">                <span class="kt">double</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">                <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%Lf%Lf&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">u</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">                <span class="n">s</span><span class="p">[</span><span class="n">id</span><span class="p">].</span><span class="n">poly</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">));</span>  
</span></span><span class="line"><span class="cl">            <span class="p">}</span>  
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">s</span><span class="p">[</span><span class="n">id</span><span class="p">].</span><span class="n">type</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">                <span class="kt">double</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">                <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%Lf%Lf&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">u</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">                <span class="n">s</span><span class="p">[</span><span class="n">id</span><span class="p">].</span><span class="n">poly</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">));</span>  
</span></span><span class="line"><span class="cl">            <span class="p">}</span>  
</span></span><span class="line"><span class="cl">        <span class="p">}</span>  
</span></span><span class="line"><span class="cl">        <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%Lf%Lf%Lf%Lf&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">h1</span><span class="p">[</span><span class="n">id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">h2</span><span class="p">[</span><span class="n">id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">t1</span><span class="p">[</span><span class="n">id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">t2</span><span class="p">[</span><span class="n">id</span><span class="p">]);</span>  
</span></span><span class="line"><span class="cl">    <span class="p">}</span>  
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">id</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">id</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(((</span><span class="n">h2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">h1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">h1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">h2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">hc</span><span class="p">)</span> <span class="o">||</span>  
</span></span><span class="line"><span class="cl">                 <span class="p">(</span><span class="n">h2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">h1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">h1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">h2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">hc</span><span class="p">))</span> <span class="o">||</span>  
</span></span><span class="line"><span class="cl">                <span class="p">((</span><span class="n">t2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">t1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">t1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">t2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">tc</span><span class="p">)</span> <span class="o">||</span>  
</span></span><span class="line"><span class="cl">                 <span class="p">(</span><span class="n">t2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">t1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">t1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">t2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">tc</span><span class="p">))</span> <span class="o">||</span>  
</span></span><span class="line"><span class="cl">                <span class="n">GJK</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="n">pc</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">                <span class="k">continue</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">            <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">        <span class="p">}</span>  
</span></span><span class="line"><span class="cl">    <span class="p">}</span>  
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>发现POJ 3608其实是这个问题的一个子集，稍微改改输入部分可以通过板子题POJ 3608。</p>
        
        <hr><p>Published on 2024-07-21 at <a href='https://username.github.io/'>终端出口</a>, last modified on 2024-07-21</p>]]></description><category>题解</category></item><item><title>计算几何入门笔记（学习中）</title><link>https://username.github.io/post/computational-geometry/</link><pubDate>Mon, 18 Mar 2024 08:52:25 +0800</pubDate><author>satori5ama@foxmail.com (Satori5ama)</author><guid>https://username.github.io/post/computational-geometry/</guid><description>
<![CDATA[<h1>计算几何入门笔记（学习中）</h1><p>Author: Satori5ama(satori5ama@foxmail.com)</p>
        
          <p>因为懒得写博客所以大部分是搬运的。</p>
<h2 id="参考文献">
<a class="header-anchor" href="#%e5%8f%82%e8%80%83%e6%96%87%e7%8c%ae"></a>
参考文献
</h2><p><a href="https://oi-wiki.org/geometry/2d/">二维计算几何基础 - OI Wiki (oi-wiki.org)</a></p>
<p><a href="https://www.luogu.com/article/1pv0nw0s">计算几何初步 - 洛谷专栏 (luogu.com)</a></p>
<p><a href="https://www.cnblogs.com/kane1990/p/5742830.html">判断两个线段是否相交 - balabala已被注册 - 博客园 (cnblogs.com)</a></p>
<p><a href="https://www.luogu.com/article/h5e6oinh">计算几何三维入门 - 洛谷专栏 (luogu.com)</a></p>
<p><a href="https://www.luogu.com/article/n1isiff4">【笔记】二维凸包 - 洛谷专栏 (luogu.com)</a></p>
<h2 id="平面计算几何基础">
<a class="header-anchor" href="#%e5%b9%b3%e9%9d%a2%e8%ae%a1%e7%ae%97%e5%87%a0%e4%bd%95%e5%9f%ba%e7%a1%80"></a>
平面计算几何基础
</h2><h3 id="线段平行">
<a class="header-anchor" href="#%e7%ba%bf%e6%ae%b5%e5%b9%b3%e8%a1%8c"></a>
线段平行
</h3><p>设线段端点分别为$P_1,P_2$和$P_3,P_4$</p>
        
        <hr><p>Published on 2024-03-18 at <a href='https://username.github.io/'>终端出口</a>, last modified on 2024-04-09</p>]]></description><category>笔记</category></item></channel></rss>