<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Reverse on 终端出口</title><link>https://username.github.io/tags/reverse/</link><description>Recent content from 终端出口</description><generator>Hugo</generator><language>en</language><managingEditor>satori5ama@foxmail.com (Satori5ama)</managingEditor><webMaster>satori5ama@foxmail.com (Satori5ama)</webMaster><copyright>All articles on this blog are licensed under the BY-NC-SA license agreement unless otherwise stated. Please indicate the source when reprinting!</copyright><lastBuildDate>Mon, 23 Dec 2024 08:55:27 +0800</lastBuildDate><atom:link href="https://username.github.io/tags/reverse/index.xml" rel="self" type="application/rss+xml"/><item><title>XCTF - 我不是病毒2.0</title><link>https://username.github.io/post/xctf-i-am-not-a-virus/</link><pubDate>Mon, 23 Dec 2024 08:55:27 +0800</pubDate><author>satori5ama@foxmail.com (Satori5ama)</author><guid>https://username.github.io/post/xctf-i-am-not-a-virus/</guid><description>
<![CDATA[<h1>XCTF - 我不是病毒2.0</h1><p>Author: Satori5ama(satori5ama@foxmail.com)</p>
        
          <p>复现完以为自己写了wp，结果好像没有。只能转一篇了。</p>
<p><a href="https://eutop1a.github.io/2023/04/01/2023XCTF-Final/">2023XCTF-Final - Eutop1a</a></p>
        
        <hr><p>Published on 2024-12-23 at <a href='https://username.github.io/'>终端出口</a>, last modified on 2024-12-23</p>]]></description><category>题解</category></item><item><title>攻防世界 - Re150</title><link>https://username.github.io/post/adworld-re150/</link><pubDate>Thu, 21 Nov 2024 08:55:27 +0800</pubDate><author>satori5ama@foxmail.com (Satori5ama)</author><guid>https://username.github.io/post/adworld-re150/</guid><description>
<![CDATA[<h1>攻防世界 - Re150</h1><p>Author: Satori5ama(satori5ama@foxmail.com)</p>
        
          <p>参考文献：<a href="https://lrhtony.cn/2023/12/28/xctf-re150/">攻防世界-Re150 - lrhtony 的小站</a></p>
<p>查壳略。</p>
<p>IDA打开，发现没有main函数，只有一个start函数。</p>
<p>start函数的汇编代码：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">D4</span> <span class="no">start</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; DATA XREF: LOAD:08048018↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">D4</span>                                         <span class="c1">; start+22↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">D4</span>                 <span class="no">jmp</span>     <span class="no">short</span> <span class="no">loc_80488EB</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">D4</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">D6</span>                 <span class="no">db</span> <span class="mi">20</span><span class="no">h</span>                  <span class="c1">; address 0x08048320
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">D7</span>                 <span class="no">db</span>  <span class="mi">83</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">D8</span>                 <span class="no">db</span>    <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">D9</span>                 <span class="no">db</span>    <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">DA</span>                 <span class="no">db</span>  <span class="mi">20</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">DB</span>                 <span class="no">db</span>  <span class="mi">83</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">DC</span>                 <span class="no">db</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">DD</span>                 <span class="no">db</span>    <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">DE</span>                 <span class="no">db</span> <span class="mi">32</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">DF</span>                 <span class="no">db</span>    <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">E0</span>                 <span class="no">db</span>    <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">E1</span>                 <span class="no">db</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">E2</span>                 <span class="no">db</span>  <span class="mi">73</span><span class="no">h</span> <span class="c1">; s
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">E3</span>                 <span class="no">db</span>  <span class="mi">79</span><span class="no">h</span> <span class="c1">; y
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">E4</span>                 <span class="no">db</span> <span class="mi">63</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">E5</span>                 <span class="no">db</span>  <span class="mi">6</span><span class="no">Ch</span> <span class="c1">; l
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">E6</span>                 <span class="no">db</span>  <span class="mi">6</span><span class="no">Fh</span> <span class="c1">; o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">E7</span>                 <span class="no">db</span>  <span class="mi">76</span><span class="no">h</span> <span class="c1">; v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">E8</span>                 <span class="no">db</span> <span class="mi">65</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">E9</span>                 <span class="no">db</span>  <span class="mi">72</span><span class="no">h</span> <span class="c1">; r
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">EA</span>                 <span class="no">db</span>  <span class="mi">0</span><span class="no">Ah</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">EB</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">EB</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">EB</span> <span class="no">loc_80488EB</span><span class="p">:</span>                            <span class="c1">; CODE XREF: start↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">EB</span>                 <span class="no">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">EC</span>                 <span class="no">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">ED</span>                 <span class="no">push</span>    <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">EE</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">EF</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">F0</span>                 <span class="no">call</span>    <span class="no">$</span><span class="err">+</span><span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">F5</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">F5</span> <span class="no">loc_80488F5</span><span class="p">:</span>                            <span class="c1">; DATA XREF: start+22↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">F5</span>                 <span class="no">pop</span>     <span class="no">ebp</span>             <span class="c1">; ebp = 0x080488F5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">F6</span>                 <span class="no">sub</span>     <span class="no">ebp</span><span class="p">,</span> <span class="p">(</span><span class="no">offset</span> <span class="no">loc_80488F5</span> <span class="p">-</span> <span class="no">offset</span> <span class="no">start</span><span class="p">)</span> <span class="c1">; ebp = start
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">080488</span><span class="nf">FC</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048901</span>                 <span class="nf">mov</span>     <span class="no">ebx</span><span class="p">,</span> <span class="mi">1</span>          <span class="c1">; fd
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">08048906</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">14</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">0804890</span><span class="nf">B</span>                 <span class="no">add</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; addr
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">0804890</span><span class="nf">D</span>                 <span class="no">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="mi">9</span>          <span class="c1">; len
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">08048912</span>                 <span class="nf">int</span>     <span class="mi">80</span><span class="no">h</span>             <span class="c1">; LINUX - sys_write
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">08048914</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">0</span><span class="no">Ah</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048919</span>                 <span class="nf">add</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">0804891</span><span class="nf">B</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ecx</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">0804891</span><span class="nf">D</span>                 <span class="no">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048922</span>                 <span class="nf">add</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048924</span>                 <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">edi</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048926</span>                 <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">0804892</span><span class="nf">B</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">0804892</span><span class="nf">B</span> <span class="no">loc_804892B</span><span class="p">:</span>                            <span class="c1">; CODE XREF: start+71↓j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">0804892</span><span class="nf">B</span>                 <span class="no">mov</span>     <span class="no">bl</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">0804892</span><span class="nf">D</span>                 <span class="no">mov</span>     <span class="no">al</span><span class="p">,</span> <span class="p">[</span><span class="no">edi</span><span class="err">+</span><span class="no">esi</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048930</span>                 <span class="nf">xor</span>     <span class="no">al</span><span class="p">,</span> <span class="mi">42</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048932</span>                 <span class="nf">shl</span>     <span class="no">al</span><span class="p">,</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048935</span>                 <span class="nf">or</span>      <span class="no">bl</span><span class="p">,</span> <span class="no">al</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048937</span>                 <span class="nf">mov</span>     <span class="no">al</span><span class="p">,</span> <span class="p">[</span><span class="no">edi</span><span class="err">+</span><span class="no">esi</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">0804893</span><span class="nf">A</span>                 <span class="no">xor</span>     <span class="no">al</span><span class="p">,</span> <span class="mi">42</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">0804893</span><span class="nf">C</span>                 <span class="no">shr</span>     <span class="no">al</span><span class="p">,</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">0804893</span><span class="nf">F</span>                 <span class="no">or</span>      <span class="no">bl</span><span class="p">,</span> <span class="no">al</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048941</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">edi</span><span class="err">+</span><span class="no">esi</span><span class="p">],</span> <span class="no">bl</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048944</span>                 <span class="nf">inc</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048945</span>                 <span class="nf">loop</span>    <span class="no">loc_804892B</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048947</span>                 <span class="nf">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048948</span>                 <span class="nf">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048949</span>                 <span class="nf">pop</span>     <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">0804894</span><span class="nf">A</span>                 <span class="no">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">0804894</span><span class="nf">B</span>                 <span class="no">pop</span>     <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">0804894</span><span class="nf">C</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048951</span>                 <span class="nf">add</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048953</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">eax</span><span class="p">]</span>      <span class="c1">; mov eax,[ebp+2]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">08048953</span>                                         <span class="c1">; 此时ebp = start,即地址0x08048320
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.eh_frame:</span><span class="err">08048955</span>                 <span class="nf">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048956</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.eh_frame:</span><span class="err">08048956</span> <span class="nf">start</span>           <span class="no">endp</span> <span class="c1">; sp-analysis failed
</span></span></span></code></pre></div><p>伪代码：</p>
        
        <hr><p>Published on 2024-11-21 at <a href='https://username.github.io/'>终端出口</a>, last modified on 2024-11-21</p>]]></description><category>题解</category></item><item><title>SUCTF2019 - hardCpp</title><link>https://username.github.io/post/suctf2019-hardcpp/</link><pubDate>Mon, 18 Nov 2024 08:55:27 +0800</pubDate><author>satori5ama@foxmail.com (Satori5ama)</author><guid>https://username.github.io/post/suctf2019-hardcpp/</guid><description>
<![CDATA[<h1>SUCTF2019 - hardCpp</h1><p>Author: Satori5ama(satori5ama@foxmail.com)</p>
        
          <p>参考文献：<a href="https://pinguw.github.io/2024/03/26/Reverse/LLVM/">去OLLVM平坦化([SUCTF2019]hardCPP) - Pinguw&rsquo;s Blog</a></p>
<p>查壳，ELF64，无壳</p>
<p><img src="https://cdn.jsdmirror.cn/gh/Satori5ama/Figurebed@main/img/reverse/1731943536190.png" alt="1731943536190"></p>
<p>IDA中发现有多层while嵌套，内部有一个switch控制分发，观察程序流程图发现明显的平坦化痕迹。</p>
<p><img src="https://cdn.jsdmirror.cn/gh/Satori5ama/Figurebed@main/img/reverse/1731943702464.png" alt="1731943702464"></p>
        
        <hr><p>Published on 2024-11-18 at <a href='https://username.github.io/'>终端出口</a>, last modified on 2024-11-18</p>]]></description><category>题解</category></item><item><title>攻防世界 - maze</title><link>https://username.github.io/post/adworld-maze/</link><pubDate>Tue, 12 Nov 2024 08:55:27 +0800</pubDate><author>satori5ama@foxmail.com (Satori5ama)</author><guid>https://username.github.io/post/adworld-maze/</guid><description>
<![CDATA[<h1>攻防世界 - maze</h1><p>Author: Satori5ama(satori5ama@foxmail.com)</p>
        
          <p>查壳，64位elf，无壳。</p>
<p><img src="https://cdn.jsdmirror.cn/gh/Satori5ama/Figurebed@main/img/reverse/clip_image002.png" alt="img"></p>
<p>进入main函数。</p>
<p><img src="https://cdn.jsdmirror.cn/gh/Satori5ama/Figurebed@main/img/reverse/clip_image004.png" alt="img"></p>
<p>伪代码：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">a2</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">a3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">__int64</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// rbx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">bool</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// bp
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">bool</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// al
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">v7</span><span class="p">;</span> <span class="c1">// rdi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// [rsp+0h] [rbp-28h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v10</span><span class="p">[</span><span class="mi">9</span><span class="p">];</span> <span class="c1">// [rsp+4h] [rbp-24h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v10</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v9</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Input flag:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">s1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="nf">strlen</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">24</span> <span class="o">||</span> <span class="nf">strncmp</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s1</span><span class="p">,</span> <span class="s">&#34;nctf{&#34;</span><span class="p">,</span> <span class="mi">5uLL</span><span class="p">)</span> <span class="o">||</span> <span class="o">*</span><span class="p">(</span><span class="o">&amp;</span><span class="n">byte_6010BF</span> <span class="o">+</span> <span class="mi">24</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">125</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="nl">LABEL_22</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Wrong flag!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="mi">5LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="nf">strlen</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">v4</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s1</span> <span class="o">+</span> <span class="n">v3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">v5</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">v4</span> <span class="o">&gt;</span> <span class="mi">78</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">v4</span> <span class="o">==</span> <span class="mi">79</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">v6</span> <span class="o">=</span> <span class="nf">sub_400650</span><span class="p">(</span><span class="n">v10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="k">goto</span> <span class="n">LABEL_14</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">v4</span> <span class="o">==</span> <span class="mi">111</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">v6</span> <span class="o">=</span> <span class="nf">sub_400660</span><span class="p">(</span><span class="n">v10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="k">goto</span> <span class="n">LABEL_14</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">v4</span> <span class="o">==</span> <span class="mi">46</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">v6</span> <span class="o">=</span> <span class="nf">sub_400670</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v9</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="k">goto</span> <span class="n">LABEL_14</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">v4</span> <span class="o">==</span> <span class="mi">48</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">v6</span> <span class="o">=</span> <span class="nf">sub_400680</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v9</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nl">LABEL_14</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">          <span class="n">v5</span> <span class="o">=</span> <span class="n">v6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="nf">sub_400690</span><span class="p">((</span><span class="kr">__int64</span><span class="p">)</span><span class="n">asc_601060</span><span class="p">,</span> <span class="n">v10</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v9</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">goto</span> <span class="n">LABEL_22</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="o">++</span><span class="n">v3</span> <span class="o">&gt;=</span> <span class="nf">strlen</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="n">v5</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nl">LABEL_20</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">v7</span> <span class="o">=</span> <span class="s">&#34;Wrong flag!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">goto</span> <span class="n">LABEL_21</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">asc_601060</span><span class="p">[</span><span class="mi">8</span> <span class="o">*</span> <span class="n">v9</span> <span class="o">+</span> <span class="n">v10</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">!=</span> <span class="mi">35</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">goto</span> <span class="n">LABEL_20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span> <span class="o">=</span> <span class="s">&#34;Congratulations!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nl">LABEL_21</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="n">v7</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>观察第一段，可以发现flag形式为nctf{开头，长度为24，结尾为}的字符串。</p>
        
        <hr><p>Published on 2024-11-12 at <a href='https://username.github.io/'>终端出口</a>, last modified on 2024-11-12</p>]]></description><category>题解</category></item></channel></rss>